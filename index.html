<!DOCTYPE html>
<html>
<head>
  <title>ConfigStorage</title>
  <style>
    /* Add your custom CSS styling here */
    h1 {
      text-align: center;
    }
    ul {
      text-align: center;
    }
    #dropArea {
      border: 2px dashed #ccc;
      padding: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>ConfigStorage</h1>

  <h2>Configs</h2>
  <ul id="fileList"></ul>

  <div id="dropArea">
    <p>Drag and drop files here</p>
  </div>

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    // GitHub repository details
    var repoOwner = 'CrimsonfiedOfficial';
    var repoName = 'ConfigStorage';
    var accessToken = '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';

    // Retrieve file list from GitHub repository
    function getFileList() {
      axios.get('https://api.github.com/repos/' + repoOwner + '/' + repoName + '/contents', {
        headers: {
          Authorization: 'Bearer ' + accessToken
        }
      })
        .then(function(response) {
          var fileList = response.data;
          var ul = document.getElementById('fileList');
          ul.innerHTML = '';

          fileList.forEach(function(file) {
            if (file.type === 'file') {
              var li = document.createElement('li');
              var link = document.createElement('a');
              link.href = file.download_url;
              link.textContent = file.name;
              li.appendChild(link);
              ul.appendChild(li);
            }
          });
        })
        .catch(function(error) {
          console.error('Error retrieving file list:', error);
        });
    }

    // Initial file list retrieval
    getFileList();

    // Handle file drop
    var dropArea = document.getElementById('dropArea');

    dropArea.addEventListener('dragenter', function(event) {
      event.preventDefault();
      dropArea.style.backgroundColor = '#f7f7f7';
    });

    dropArea.addEventListener('dragover', function(event) {
      event.preventDefault();
    });

    dropArea.addEventListener('dragleave', function(event) {
      event.preventDefault();
      dropArea.style.backgroundColor = '';
    });

    dropArea.addEventListener('drop', function(event) {
      event.preventDefault();
      dropArea.style.backgroundColor = '';

      var files = event.dataTransfer.files;
      if (files.length > 0) {
        uploadFiles(files);
      }
    });

    // Upload files to GitHub repository
    function uploadFiles(files) {
      var uploadPromises = [];

      for (var i = 0; i < files.length; i++) {
        var file = files[i];
        var formData = new FormData();
        formData.append('file', file);

        var uploadPromise = axios.put('https://api.github.com/repos/' + repoOwner + '/' + repoName + '/contents/' + file.name, formData, {
          headers: {
            Authorization: 'Bearer ' + accessToken,
            'Content-Type': 'application/octet-stream'
          }
        });

        uploadPromises.push(uploadPromise);
      }

      Promise.all(uploadPromises)
        .then(function(response) {
          getFileList(); // Refresh file list after upload
        })
        .catch(function(error) {
          console.error('Error uploading files:', error);
        });
    }
  </script>
</body>
</html>
